"use strict";!function(){function e(e,t){var a=new ol.style.Stroke({color:e,width:1.5}),l=new ol.style.Fill({color:t});return function(e){var t=[new ol.style.Style({stroke:a,fill:l,image:new ol.style.Circle({fill:l,stroke:a,radius:3})})];if(this.getGeometry()instanceof ol.geom.LineString||this.getGeometry()instanceof ol.geom.Polygon||this.getGeometry()instanceof ol.geom.MultiLineString||this.getGeometry()instanceof ol.geom.MultiPolygon){var r=new ol.style.Style({image:new ol.style.RegularShape({fill:new ol.style.Fill({color:"black"}),stroke:new ol.style.Stroke({color:"black",width:1}),points:4,radius:5,radius2:0,angle:Math.PI/4}),geometry:function(e){var t=i.read(e.getGeometry()).getCoordinates().map(function(e){return[e.x,e.y]});return new ol.geom.MultiPoint(t)}});t.push(r)}return t}}function t(e,t,a){f.getProxy().setUrl("../testxml/validate/"+t.data.filename),f.reload(),m.reset()}function a(e,t,a){m.showTestCase(t)}function l(){Ext.create("Ext.Viewport",{padding:10,layout:"fit",items:{title:"JSTS validation suite",items:[w,m]}})}var r=Ext.create("Ext.panel.Panel",{title:"IM result",flex:1,frame:!0,padding:5,showTestResults:function(e,t){var a=e.relate(t);this.update("IM: "+a.toString()+"<br>equals: "+a.isEquals(2,2)+"<br>disjoint: "+a.isDisjoint()+"<br>intersects: "+a.isIntersects()+"<br>touches: "+a.isTouches(2,2)+"<br>crosses: "+a.isCrosses(2,2)+"<br>within: "+a.isWithin()+"<br>contains: "+a.isContains()+"<br>overlaps: "+a.isOverlaps(2,2)+"<br>")},reset:function(){this.update("")}}),i=new jsts.io.OL3Parser,o=new ol.Collection,s=new ol.source.Vector({features:o}),n=new ol.layer.Vector({source:s}),d=new ol.Map({controls:[],layers:[n],view:new ol.View({center:[0,0],zoom:10})}),c=Ext.create("Ext.panel.Panel",{html:'<div id="map" style="width:200px;height:200px"></div>',listeners:{afterrender:function(){d.setTarget("map")}}}),u=Ext.create("Ext.panel.Panel",{html:""}),m=Ext.create("Ext.panel.Panel",{layout:{type:"hbox",align:"stretch"},items:[{title:"Visual",height:200,width:200,layout:"fit",frame:!0,items:c},{title:"Input",padding:5,height:150,width:400,layout:"fit",frame:!0,flex:1,items:u},r],showTestCase:function(t){var a=new jsts.io.WKTReader,l=new jsts.io.WKTWriter,n=a.read(t.data.a),c=a.read(t.data.b);r.showTestResults(n,c),u.update(l.write(n)+"<br><br>"+l.write(c));var m=new ol.Feature({geometry:i.write(n)});m.setStyle(e([0,0,255,.5],[0,0,255,.3]));var x=new ol.Feature({geometry:i.write(c)});x.setStyle(e([255,0,0,.5],[255,0,0,.3])),o.clear(),o.extend([m,x]);var y=d.getView(),f=s.getExtent();y.fit(f,d.getSize()),d.updateSize()},reset:function(){s.clear(),u.update("")}}),x=[[0,"TestRelatePP.xml"],[1,"TestRelatePL.xml"],[2,"TestRelatePA.xml"],[3,"TestRelateLL.xml"],[4,"TestRelateLC.xml"],[5,"TestRelateLA.xml"],[6,"TestRelateAC.xml"],[7,"TestRelateAA.xml"]],y=Ext.create("Ext.data.ArrayStore",{id:0,fields:["id","filename"],data:x});Ext.define("Case",{extend:"Ext.data.Model",proxy:{type:"ajax",reader:"xml"},fields:["desc","a","b"]});var f=Ext.create("Ext.data.Store",{model:"Case",proxy:{type:"ajax",url:"../testxml/validate/TestRelatePP.xml",reader:{type:"xml",record:"case"}},autoLoad:!0}),g=Ext.create("Ext.form.ComboBox",{width:450,xtype:"combo",fieldLabel:"Case",name:"case",ref:"../case",store:f,triggerAction:"all",lazyRender:!0,displayField:"desc",listeners:{select:a}});f.on("load",function(e,t){var a=t[0];g.select(a),m.showTestCase(a)});var w=Ext.create("Ext.panel.Panel",{layout:"form",items:[{width:150,xtype:"combo",fieldLabel:"Group",name:"group",ref:"group",store:y,triggerAction:"all",lazyRender:!0,mode:"local",valueField:"id",displayField:"filename",value:0,listeners:{select:t}},g]});Ext.onReady(l)}();
